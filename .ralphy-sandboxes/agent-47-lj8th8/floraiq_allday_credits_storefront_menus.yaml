name: FloraIQ All-Day Sprint - Credits, Storefront & Disposable Menus
description: >
  12-hour comprehensive sprint covering FloraIQ's three major monetization
  features.

  Run this all day for deep verification, enhancement, and hardening.
version: 3.0.0
estimated_hours: 12
rules:
  - Use TypeScript strict mode with explicit types
  - Always include tenant_id isolation in database queries
  - Use TanStack Query with proper cache invalidation
  - Credits must be checked BEFORE expensive operations
  - All menu access must be logged for audit
  - Stripe webhooks must be idempotent
  - Use optimistic updates for better UX
  - Add loading states to all async operations
  - Test edge cases thoroughly
tasks:
  - id: verify-credits-hook-realtime
    title: Verify useCredits Hook with Real-time Updates
    priority: P0
    estimated_minutes: 35
    description: |
      Verify src/hooks/useCredits.ts:

      1. Credit balance query fetches correctly from tenant_credits table
      2. Real-time subscription updates balance on changes
      3. Low balance warnings at 2000, 1000, 500, 100 credits
      4. Balance displays in header with color coding
      5. Click opens purchase modal

      Add real-time subscription:
      ```typescript
      useEffect(() => {
        if (!tenant?.id) return;
        const channel = supabase
          .channel(`credits:${tenant.id}`)
          .on('postgres_changes', {
            event: '*',
            schema: 'public',
            table: 'tenant_credits',
            filter: `tenant_id=eq.${tenant.id}`
          }, () => queryClient.invalidateQueries(['credits', tenant.id]))
          .subscribe();
        return () => supabase.removeChannel(channel);
      }, [tenant?.id]);
      ```
    acceptance_criteria:
      - Balance loads correctly on page load
      - Real-time updates work instantly
      - Color coding shows green >5000, yellow >1000, red <1000
    completed: true
  - id: verify-credit-gating-middleware
    title: Verify Credit Gating Middleware - Backend Protection
    priority: P0
    estimated_minutes: 45
    description: |
      Verify supabase/functions/_shared/creditGate.ts:

      1. Blocks operations when balance insufficient
      2. Idempotency key prevents duplicate deductions
      3. Paid tiers (pro, enterprise) bypass credit checks
      4. Low balance alerts trigger at thresholds
      5. Auto-top-up queued when balance low

      Verify consume_credits RPC:
      - Atomic deduction with row locking
      - Returns new balance
      - Logs to credit_deductions table
      - Prevents negative balance

      Create migration for credit tables if not exists:
      - tenant_credits (balance, auto_topup settings)
      - credit_deductions (audit log)
      - credit_purchases (stripe records)
      - credit_alerts (notification tracking)
    acceptance_criteria:
      - Operations blocked at 0 credits
      - Idempotency prevents double charges
      - Paid tiers work without credit deduction
    completed: true
  - id: verify-use-credit-gated-action
    title: Verify useCreditGatedAction Frontend Hook
    priority: P0
    estimated_minutes: 30
    description: |
      Verify src/hooks/useCreditGatedAction.ts:

      1. Checks balance before executing action
      2. Shows OutOfCreditsModal when insufficient
      3. Optimistic UI update deducts immediately
      4. Reverts on error
      5. Pre-configured hooks: useGenerateMenu, useCreateStorefront

      Test flow:
      - User clicks action button
      - Hook checks balance
      - If sufficient: deduct optimistically, execute, confirm
      - If insufficient: show modal with purchase options
    acceptance_criteria:
      - Balance check happens before action
      - Modal shows with purchase options
      - Optimistic update works and reverts on error
    completed: true
  - id: verify-free-tier-grant
    title: Verify Free Tier Credit Grant on Signup
    priority: P0
    estimated_minutes: 25
    description: |
      Verify grant-free-credits edge function:

      1. New tenants receive 10,000 credits automatically
      2. Database trigger OR cron job runs reliably
      3. No duplicate grants (idempotency)
      4. Welcome email sent with credit info
      5. Different plans get appropriate amounts:
         - Free: 10,000
         - Starter: 25,000
         - Pro: 100,000
         - Enterprise: 500,000

      Check cron schedule in Supabase dashboard.
      Verify database trigger on tenants table INSERT.
    acceptance_criteria:
      - New tenant gets credits automatically
      - No duplicates on retry
      - Correct amount per plan
    completed: true
  - id: verify-credit-purchase-stripe
    title: Verify Credit Purchase Flow with Stripe
    priority: P0
    estimated_minutes: 45
    description: |
      Verify purchase-credits edge function:

      1. List packages action returns 4 tiers:
         - 5,000 credits - $9.99
         - 15,000 credits - $24.99 (popular)
         - 50,000 credits - $49.99
         - 150,000 credits - $179.99

      2. Create checkout action:
         - Gets/creates Stripe customer
         - Creates credit_purchases record
         - Creates Stripe checkout session
         - Returns session URL

      3. Stripe webhook handler:
         - Verifies signature
         - Checks idempotency (already processed)
         - Adds credits via add_credits RPC
         - Updates purchase status
         - Sends confirmation email

      Verify frontend CreditPurchaseModal:
      - Package selection UI
      - Redirect to Stripe
      - Success page after return
      - CreditPurchaseCelebration animation
    acceptance_criteria:
      - All 4 packages display correctly
      - Stripe checkout creates successfully
      - Webhook adds credits atomically
      - Celebration animation fires
    completed: true
  - id: verify-auto-topup-system
    title: Verify Auto Top-Up System
    priority: P1
    estimated_minutes: 40
    description: |
      Verify process-auto-topup edge function:

      1. Triggered when balance < threshold
      2. Checks auto_topup_enabled setting
      3. Verifies saved payment method exists
      4. Rate limits: max 3 top-ups per hour
      5. Creates PaymentIntent with saved card
      6. Confirms payment off-session
      7. Adds credits on success
      8. Sends success/failure notification

      Verify AutoTopUpSettings component:
      - Toggle enabled/disabled
      - Threshold slider (100-5000)
      - Amount slider (1000-50000)
      - Payment method management
      - Save settings to tenant_credits
    acceptance_criteria:
      - Auto top-up triggers at threshold
      - Rate limiting prevents runaway charges
      - Notifications sent on success/failure
    completed: true
  - id: verify-out-of-credits-modal
    title: Verify OutOfCreditsModal and Alerts
    priority: P1
    estimated_minutes: 25
    description: |
      Verify OutOfCreditsModal component:

      1. Shows required vs available credits
      2. Progress bar visualization
      3. Quick purchase buttons (5K, 15K)
      4. Auto top-up setup suggestion
      5. All packages link

      Verify CreditAlertBanner:
      - Shows at 2000, 1000, 500, 100 credits
      - Dismissible but returns on balance change
      - Buy credits button
      - Different severity colors
    acceptance_criteria:
      - Modal blocks action when insufficient
      - Quick purchase buttons work
      - Banners appear at thresholds
    completed: true
  - id: verify-credit-analytics
    title: Verify Credit Analytics Dashboard
    priority: P2
    estimated_minutes: 30
    description: |
      Verify CreditAnalytics page:

      1. Stats cards: balance, 30-day usage, daily avg, days remaining
      2. Usage over time line chart
      3. Usage breakdown pie chart
      4. Top credit consumers bar chart
      5. Purchase history table
      6. Auto top-up settings tab

      Queries needed:
      - credit_deductions for last 30 days
      - credit_usage_logs grouped by action
      - credit_purchases history
    acceptance_criteria:
      - Charts render with real data
      - Days remaining calculated correctly
      - Purchase history shows
    completed: true
  - id: verify-storefront-builder
    title: Verify Storefront Builder Admin Interface
    priority: P1
    estimated_minutes: 50
    description: >
      Verify StorefrontBuilder.tsx (856 lines):


      1. Store Creation:
         - Create button deducts 500 credits
         - Store saves to marketplace_stores
         - Slug uniqueness validated

      2. Section Management:
         - Add section dropdown (8 types)
         - Section types: Hero, ProductGrid, Features, Testimonials, Newsletter, Gallery, FAQ, CustomHTML
         - Each section has edit dialog
         - Delete with confirmation

      3. Drag and Drop:
         - Sections reorder via drag
         - Visual feedback during drag
         - Order persists to layout_config

      4. Preview Panel:
         - Real-time preview updates
         - Desktop/mobile toggle
         - Fix calc(100vh - 56px) height if needed

      5. Save and Publish:
         - Save draft works
         - Publish makes store public
         - Unpublish returns to draft
    acceptance_criteria:
      - Store creation deducts credits
      - All 8 section types work
      - Drag drop reorders
      - Preview matches actual storefront
    completed: true
  - id: verify-storefront-themes
    title: Verify Storefront Theme System
    priority: P1
    estimated_minutes: 35
    description: |
      Verify storefrontThemes.ts:

      4 themes with CSS variables:
      1. Dark Mode - #0a0a0a bg, #22c55e primary, neon accents
      2. Minimalist - #ffffff bg, #0f172a primary, clean
      3. Strain Focused - #fefce8 bg, #65a30d primary, nature
      4. Luxury - #0c0a09 bg, #d4af37 gold primary

      Each theme needs:
      - --storefront-bg, --storefront-text
      - --storefront-primary, --storefront-accent
      - --storefront-card-bg, --storefront-border
      - --storefront-radius, --storefront-shadow
      - Font pairings (heading/body)

      Verify ThemeSelector component:
      - Preview cards for each theme
      - Selection persists
      - CSS variables apply correctly
    acceptance_criteria:
      - All 4 themes render correctly
      - CSS variables apply to storefront
      - Theme persists after save
    completed: true
  - id: verify-sync-products-marketplace
    title: Verify sync_product_to_marketplace RPC
    priority: P1
    estimated_minutes: 25
    description: |
      Verify RPC functions:

      1. sync_product_to_marketplace:
         - Creates/updates marketplace_products record
         - Supports display_name, display_price overrides
         - Sets is_featured flag
         - Generates slug

      2. sync_all_products_to_marketplace:
         - Bulk syncs all active products with stock
         - Upserts to avoid duplicates

      Verify marketplace_products table:
      - store_id, product_id, tenant_id
      - display_name, display_price overrides
      - is_visible, is_featured flags
      - slug for SEO

      RLS policies:
      - Public can view visible products
      - Tenants can manage their own
    acceptance_criteria:
      - Products sync correctly
      - Overrides work
      - Bulk sync handles all products
    completed: true
  - id: verify-storefront-page
    title: Verify Customer Storefront Page
    priority: P1
    estimated_minutes: 30
    description: |
      Verify /shop/:storeSlug route:

      1. Loads correct store by slug
      2. 404 for non-existent stores
      3. Theme CSS variables apply
      4. All sections render from layout_config
      5. Hero section displays
      6. ProductGrid shows featured products
      7. Navigation to catalog works

      No login required for browsing.
    acceptance_criteria:
      - Store loads by slug
      - Theme applies correctly
      - All sections render
    completed: true
  - id: verify-product-catalog-detail
    title: Verify Product Catalog and Detail Pages
    priority: P1
    estimated_minutes: 35
    description: |
      Verify ProductCatalogPage:
      - All synced products display
      - Category filter works
      - Strain type filter (indica/sativa/hybrid)
      - Price range filter
      - THC/CBD range filters
      - Search works
      - Sort options (price, name, THC%)
      - Pagination works

      Verify ProductDetailPage:
      - Product info displays
      - Image gallery works
      - Strain type badge
      - THC/CBD percentages
      - Price displays
      - Quantity selector
      - Weight selector (if applicable)
      - Add to cart button
      - Stock status
      - Related products
    acceptance_criteria:
      - Filters work correctly
      - Add to cart works
      - Weight selection works
    completed: true
  - id: verify-cart-checkout
    title: Verify Cart and Checkout Flow
    priority: P1
    estimated_minutes: 45
    description: |
      Verify CartPage:
      - Items display correctly
      - Quantity can be changed
      - Items can be removed
      - Subtotal calculates
      - Cart persists in localStorage
      - Empty state shows

      Verify CheckoutPage (1455 lines):
      - Customer info form validates
      - Delivery/pickup selection
      - Delivery address form
      - ID verification acknowledgment
      - Age verification (21+)
      - Order summary accurate
      - Tax calculation correct
      - Stripe Elements load
      - Payment processing
      - Order confirmation
      - Confirmation email

      Verify storefront-checkout edge function:
      - Creates storefront_orders record
      - Creates Stripe PaymentIntent
      - Returns clientSecret
    acceptance_criteria:
      - Cart persists in localStorage
      - Checkout validates all fields
      - Stripe payment works
      - Order confirmation shows
    completed: true
  - id: verify-storefront-live-orders
    title: Verify Storefront Live Orders Dashboard
    priority: P1
    estimated_minutes: 30
    description: |
      Verify StorefrontLiveOrders page:

      1. Real-time order updates via subscription
      2. New order sound plays
      3. Browser notification if permitted
      4. Order cards show status, customer, items
      5. Status update dropdown
      6. Status progression: pending → confirmed → preparing → ready → delivered
      7. Filter by status
      8. Delivery vs pickup badge

      Real-time subscription on storefront_orders table.
    acceptance_criteria:
      - New orders appear instantly
      - Sound plays on new order
      - Status updates work
    completed: true
  - id: verify-storefront-analytics
    title: Verify Storefront Analytics Dashboard
    priority: P2
    estimated_minutes: 25
    description: |
      Verify StorefrontAnalytics page:

      1. Revenue chart (daily/weekly/monthly)
      2. Orders count
      3. Conversion rate
      4. Average order value
      5. Top selling products
      6. Traffic sources
      7. Date range filter

      Queries from storefront_orders aggregated.
    acceptance_criteria:
      - Revenue chart shows real data
      - Metrics calculate correctly
      - Date filtering works
    completed: true
  - id: verify-menu-generate-function
    title: Verify menu-generate Edge Function
    priority: P1
    estimated_minutes: 40
    description: |
      Verify menu-generate edge function:

      1. Generates unique token (32 char hex)
      2. Creates encrypted URL
      3. Sets expiration time
      4. Sets max views limit
      5. Optional access code
      6. Optional geofencing (lat/lng/radius)
      7. Creates disposable_menus record
      8. Deducts credits (100)

      Token should have sufficient entropy.
      URL encryption prevents tampering.

      Menu options:
      - expiration_hours: 1-168 (default 24)
      - max_views: 1-1000 (default 100)
      - access_code: optional 4-8 digit
      - geofencing: { lat, lng, radius_miles }
      - products: array of product IDs to include
      - custom_prices: map of product_id → price
    acceptance_criteria:
      - Token is cryptographically random
      - URL encryption works
      - All options save correctly
      - Credits deducted
  - id: verify-create-menu-dialog
    title: Verify CreateMenuDialog Component
    priority: P1
    estimated_minutes: 30
    description: |
      Verify CreateMenuDialog UI:

      1. Product multi-select
      2. Custom price overrides per product
      3. Expiration time picker
      4. Max views slider
      5. Access code toggle and input
      6. Geofencing toggle and map
      7. Generate button (credit gated)
      8. Copy link button after creation
      9. QR code generation

      Verify SmartDashboard shows:
      - Active menus count
      - Total views
      - Burn rate
      - Recent menu activity
    acceptance_criteria:
      - All options configurable
      - Credit check before generate
      - Link and QR code provided
  - id: verify-menu-access-validate
    title: Verify menu-access-validate Edge Function
    priority: P1
    estimated_minutes: 35
    description: |
      Verify menu-access-validate:

      1. Validates token exists
      2. Checks menu not burned
      3. Checks menu not expired
      4. Checks view count < max_views
      5. Validates access code if required
      6. Validates geolocation if enabled
      7. Logs access attempt to menu_access_logs
      8. Increments view count
      9. Returns menu data if valid

      Error responses:
      - 404: Menu not found
      - 410: Menu burned
      - 403: Invalid access code
      - 403: Outside geofence
      - 429: Max views exceeded
    acceptance_criteria:
      - All validation rules enforced
      - Access logged
      - View count increments
  - id: verify-secure-menu-access
    title: Verify SecureMenuAccess Customer Page
    priority: P1
    estimated_minutes: 40
    description: |
      Verify SecureMenuAccess page:

      1. Token extracted from URL
      2. Access code prompt if required
      3. Geolocation check if required
      4. Menu products display
      5. Custom prices shown
      6. Add to cart works
      7. Cart persists in localStorage
      8. Checkout without login

      UI should show:
      - Store branding
      - Product grid with prices
      - Cart summary
      - Checkout button
      - Expiration countdown
      - Views remaining
    acceptance_criteria:
      - Menu loads with valid token
      - Access code prompt works
      - Products display with custom prices
      - Cart works
  - id: verify-menu-cart-context
    title: Verify MenuCartContext and Store
    priority: P1
    estimated_minutes: 25
    description: |
      Verify MenuCartContext and menuCartStore:

      1. Cart state management
      2. Add item with quantity/weight
      3. Update quantity
      4. Remove item
      5. Calculate subtotal
      6. Persist to localStorage
      7. Clear cart on order complete

      Ensure MenuCartContext and menuCartStore are synchronized.
      They might be duplicates - consolidate if needed.
    acceptance_criteria:
      - Cart state works correctly
      - Persists across page refresh
      - Clears after order
  - id: verify-menu-order-place
    title: Verify menu-order-place Edge Function
    priority: P1
    estimated_minutes: 35
    description: |
      Verify menu-order-place edge function:

      Validations:
      1. Menu token valid
      2. Menu not burned/expired
      3. Quantities within limits
      4. Products still available
      5. Custom prices match menu config

      Order creation:
      1. Creates order in menu_orders table
      2. Syncs to main orders table via trigger
      3. Sends order notification to tenant
      4. Returns order confirmation

      Verify sync_menu_order_to_systems trigger:
      - Creates corresponding order in orders table
      - Links menu_order_id
      - Copies customer info
    acceptance_criteria:
      - All validations enforced
      - Order creates in both tables
      - Notification sent
  - id: verify-menu-burn-function
    title: Verify menu-burn Edge Function
    priority: P1
    estimated_minutes: 30
    description: |
      Verify menu-burn edge function:

      1. Manual burn from admin
      2. Sets burned_at timestamp
      3. Sets burn_reason
      4. Invalidates all cache
      5. Returns 410 Gone for future access

      Burn reasons:
      - manual: Admin triggered
      - max_views: View limit exceeded
      - expired: Time limit reached
      - screenshot: Screenshot detected
      - velocity: Too many requests
      - suspicious: Unusual activity
    acceptance_criteria:
      - Burn sets timestamp and reason
      - Future access returns 410
      - Cache invalidated
  - id: verify-auto-burn-triggers
    title: Verify Auto-Burn Trigger System
    priority: P1
    estimated_minutes: 40
    description: |
      Verify auto-burn.ts and triggers:

      1. Max views exceeded:
         - After each access, check if view_count >= max_views
         - Auto-burn if exceeded

      2. Expiration reached:
         - Cron job checks expired menus
         - Burns any past expiration

      3. Screenshot detection:
         - Frontend detects screenshot attempt
         - Sends burn request
         - Immediate burn

      4. Velocity threshold:
         - velocity-check.ts tracks request rate
         - Burns if >10 requests/minute

      Verify useBurnMenu hook for manual burn from UI.
    acceptance_criteria:
      - Max views triggers burn
      - Expiration cron works
      - Screenshot detection burns
      - Velocity check triggers burn
  - id: verify-menu-audit-logging
    title: Verify Menu Audit Logging System
    priority: P1
    estimated_minutes: 25
    description: |
      Verify menu_access_logs table and logging:

      Logged events:
      - access_attempt: Any access try
      - access_granted: Successful view
      - access_denied: Failed validation
      - order_placed: Order submitted
      - burn_triggered: Menu burned

      Log fields:
      - menu_id, tenant_id
      - event_type
      - ip_address (hashed)
      - user_agent
      - geolocation
      - access_code_used
      - timestamp

      Verify admin can view access logs.
      Real-time viewer count in admin.
    acceptance_criteria:
      - All events logged
      - IP hashed for privacy
      - Admin can view logs
  - id: verify-velocity-checker
    title: Verify Velocity Check Security
    priority: P1
    estimated_minutes: 25
    description: |
      Verify velocity-check.ts:

      1. Tracks request rate per menu
      2. Uses Redis or in-memory cache
      3. Threshold: 10 requests/minute
      4. Triggers burn on exceed
      5. Logs suspicious activity

      Implementation:
      - Store timestamps of last N requests
      - Check if N requests in <1 minute
      - If exceeded, return 429 and burn
    acceptance_criteria:
      - Rate limiting works
      - Burns on rapid access
      - Logs suspicious IPs
  - id: verify-menu-whitelist
    title: Verify Menu Whitelist System
    priority: P2
    estimated_minutes: 20
    description: |
      Verify menu-whitelist-manage edge function:

      1. Add email/phone to whitelist
      2. Remove from whitelist
      3. Whitelist enforcement in access validation
      4. Only whitelisted users can access

      Use case: Private menus for specific customers.
    acceptance_criteria:
      - Whitelist add/remove works
      - Access blocked if not whitelisted
  - id: verify-screenshot-detection
    title: Verify Screenshot Detection
    priority: P2
    estimated_minutes: 20
    description: |
      Verify frontend screenshot detection:

      Methods:
      1. Visibility change detection
      2. Print screen key detection
      3. CSS screenshot detection (opacity tricks)
      4. DevTools detection

      On detection:
      - Send burn request
      - Show warning message
      - Log event

      Note: Not foolproof, but adds friction.
    acceptance_criteria:
      - Detection triggers burn request
      - Warning shown to user
      - Event logged
  - id: deploy-all-edge-functions
    title: Deploy All Edge Functions to Production
    priority: P1
    estimated_minutes: 30
    description: |
      Deploy to project: mtvwmyerntkhrcdnhahp

      Commands:
      ```bash
      supabase link --project-ref mtvwmyerntkhrcdnhahp
      supabase functions deploy
      ```

      Critical functions to verify:
      - grant-free-credits (cron)
      - purchase-credits
      - process-auto-topup
      - credit-threshold-alerts
      - storefront-checkout
      - menu-generate
      - menu-access-validate
      - menu-order-place
      - menu-burn
    acceptance_criteria:
      - All functions deployed
      - No errors in logs
  - id: verify-secrets-configured
    title: Verify All Secrets Configured
    priority: P1
    estimated_minutes: 15
    description: |
      Check secrets:
      ```bash
      supabase secrets list --project-ref mtvwmyerntkhrcdnhahp
      ```

      Required:
      - SUPABASE_SERVICE_ROLE_KEY
      - JWT_SECRET
      - STRIPE_SECRET_KEY
      - STRIPE_WEBHOOK_SECRET
      - RESEND_API_KEY
      - REDIS_HOST
      - REDIS_PASSWORD
      - REDIS_PORT
      - ENCRYPTION_KEY
    acceptance_criteria:
      - All secrets present
      - No functions failing
  - id: e2e-testing-all-features
    title: End-to-End Testing of All Features
    priority: P1
    estimated_minutes: 45
    description: |
      Complete E2E test flows:

      CREDITS:
      1. Check balance in header
      2. Try action with insufficient credits
      3. Purchase credits via Stripe (test mode)
      4. Verify balance updated
      5. Enable auto top-up
      6. View analytics

      STOREFRONT:
      1. Create new store (500 credits)
      2. Add sections, choose theme
      3. Sync products
      4. Publish store
      5. Browse as customer
      6. Add to cart, checkout
      7. View order in live orders

      DISPOSABLE MENUS:
      1. Create menu with options
      2. Copy link, access as customer
      3. Enter access code
      4. Add products, place order
      5. View in admin
      6. Manually burn menu
      7. Try to access burned menu (410)
    acceptance_criteria:
      - All flows complete without errors
      - Credits deduct correctly
      - Orders appear in admin
metadata:
  project: FloraIQ
  features:
    - Credits System
    - Storefront Builder
    - Disposable Menus
  supabase_project_ref: mtvwmyerntkhrcdnhahp
  total_tasks: 28
  estimated_duration_hours: 12
  key_edge_functions:
    credits:
      - grant-free-credits
      - purchase-credits
      - process-auto-topup
      - credit-threshold-alerts
    storefront:
      - storefront-checkout
      - sync-products-marketplace
    menus:
      - menu-generate
      - menu-access-validate
      - menu-order-place
      - menu-burn
      - menu-whitelist-manage
  key_components:
    credits:
      - src/hooks/useCredits.ts
      - src/hooks/useCreditGatedAction.ts
      - src/components/credits/CreditPurchaseModal.tsx
      - src/components/credits/OutOfCreditsModal.tsx
      - src/components/credits/AutoTopUpSettings.tsx
      - supabase/functions/_shared/creditGate.ts
    storefront:
      - src/pages/admin/storefront/StorefrontBuilder.tsx
      - src/pages/admin/storefront/StorefrontSettings.tsx
      - src/pages/shop/StorefrontPage.tsx
      - src/pages/shop/CheckoutPage.tsx
      - src/lib/storefrontThemes.ts
    menus:
      - src/components/admin/disposable-menus/CreateMenuDialog.tsx
      - src/components/admin/disposable-menus/SmartDashboard.tsx
      - src/pages/customer/SecureMenuAccess.tsx
      - src/contexts/MenuCartContext.tsx
      - src/lib/security/auto-burn.ts
